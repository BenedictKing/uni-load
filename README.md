# uni-load

ğŸš€ **AI ç«™ç‚¹è‡ªåŠ¨é…ç½®å·¥å…·** - è¿æ¥ uni-api ä¸ gpt-load çš„ä¸­é—´æ¡¥æ¢

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

uni-load æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–é…ç½®å·¥å…·ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿå°†ç¬¬ä¸‰æ–¹ AI ç«™ç‚¹é›†æˆåˆ° uni-api å’Œ gpt-load ç³»ç»Ÿä¸­ã€‚é€šè¿‡ç®€å•çš„ Web ç•Œé¢ï¼Œç”¨æˆ·åªéœ€è¾“å…¥ AI ç«™ç‚¹çš„ `baseurl` å’Œ `apikey`ï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹å·¥ä½œï¼š

1. ğŸ” **è·å–æ¨¡å‹åˆ—è¡¨** - è°ƒç”¨ AI ç«™ç‚¹çš„ `/v1/models` æ¥å£
2. ğŸ—ï¸ **åˆ›å»ºä¸¤å±‚åˆ†ç»„** - åœ¨ gpt-load ä¸­åˆ›å»ºç«™ç‚¹åˆ†ç»„å’Œæ¨¡å‹åˆ†ç»„
3. âš–ï¸ **é…ç½®è´Ÿè½½å‡è¡¡** - æ¨¡å‹åˆ†ç»„æŒ‡å‘å¤šä¸ªç«™ç‚¹åˆ†ç»„ï¼Œå®ç°è‡ªåŠ¨è´Ÿè½½å‡è¡¡
4. ğŸ“ **æ›´æ–°é…ç½®æ–‡ä»¶** - è‡ªåŠ¨ä¿®æ”¹ uni-api çš„ `api.yaml` é…ç½®
5. ğŸ¯ **ç»Ÿä¸€å…¥å£è®¿é—®** - ç”¨æˆ·é€šè¿‡ uni-api ç»Ÿä¸€å…¥å£è®¿é—®æ‰€æœ‰ AI æ¨¡å‹

## ğŸŒ gpt-load å¤šå®ä¾‹æ”¯æŒ

æ”¯æŒè¿æ¥å¤šä¸ª gpt-load å®ä¾‹ï¼Œè‡ªåŠ¨ä¸ºä¸åŒç«™ç‚¹é€‰æ‹©æœ€ä½³å®ä¾‹ï¼š

### å¿…éœ€é…ç½®

> **é‡è¦**ï¼šå¯åŠ¨æœåŠ¡å‰å¿…é¡»é…ç½® gpt-load å®ä¾‹ï¼Œå¦åˆ™æœåŠ¡æ— æ³•å¯åŠ¨ï¼

1. **å¤åˆ¶é…ç½®æ–‡ä»¶**

   ```bash
   cp gptload-instances.json.example gptload-instances.json
   ```

2. **ç¼–è¾‘é…ç½®æ–‡ä»¶**
   ```json
   [
     {
       "id": "local",
       "name": "æœ¬åœ° gpt-load",
       "url": "http://localhost:3001",
       "priority": 1,
       "description": "æœ¬åœ°æœåŠ¡ï¼Œä¼˜å…ˆä½¿ç”¨",
       "upstream_addresses": [
         "https://us.gpt-load.example.com",
         "https://eu.gpt-load.example.com"
       ]
     },
     {
       "id": "us-proxy", 
       "name": "ç¾å›½ä»£ç† gpt-load",
       "url": "https://us.gpt-load.example.com",
       "token": "your-token-here",
       "priority": 2,
       "description": "ç”¨äºæœ¬åœ°ä¸æ˜“è®¿é—®çš„ç«™ç‚¹",
       "upstream_addresses": [
         "https://eu.gpt-load.example.com"
       ]
     },
     {
       "id": "eu-proxy",
       "name": "æ¬§æ´²ä»£ç† gpt-load", 
       "url": "https://eu.gpt-load.example.com",
       "token": "your-token-here",
       "priority": 3,
       "description": "æ¬§æ´²æœåŠ¡å™¨ï¼Œæœ€åå¤‡é€‰",
       "upstream_addresses": []
     }
   ]
   ```

### æ™ºèƒ½è·¯ç”±

- **ä¼˜å…ˆçº§æ’åº**: æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜
- **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨æ£€æµ‹å®ä¾‹çŠ¶æ€
- **è¿é€šæ€§æµ‹è¯•**: æµ‹è¯•å®ä¾‹æ˜¯å¦èƒ½è®¿é—®ç›®æ ‡ç«™ç‚¹
- **æ•…éšœè½¬ç§»**: è‡ªåŠ¨åˆ‡æ¢åˆ°å¯ç”¨å®ä¾‹

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

uni-load é‡‡ç”¨ä¸‰å±‚åˆ†ç»„æ¶æ„å®ç° AI æ¨¡å‹çš„ç»Ÿä¸€ç®¡ç†ã€‚åœ¨å¤šå®ä¾‹ç¯å¢ƒä¸‹ï¼Œç¬¬ä¸€å±‚ï¼ˆç«™ç‚¹åˆ†ç»„ï¼‰ä¼šè¢«æ™ºèƒ½åœ°åˆ†é…åˆ°ç½‘ç»œè¿æ¥æœ€ä½³çš„ gpt-load å®ä¾‹ä¸Šï¼Œè€Œç¬¬äºŒã€ä¸‰å±‚ï¼ˆæ¨¡å‹åˆ†ç»„ï¼‰åˆ™ç»Ÿä¸€åˆ›å»ºåœ¨é¦–é€‰å®ä¾‹ä¸Šï¼Œä»¥ç¡®ä¿å†…éƒ¨è·¯ç”±çš„ç¨³å®šã€‚

```
ç”¨æˆ·è¯·æ±‚ â†’ uni-api â†’ æ¨¡å‹èšåˆåˆ†ç»„ â†’ æ¨¡å‹-æ¸ é“åˆ†ç»„ â†’ ç«™ç‚¹åˆ†ç»„ â†’ AIæœåŠ¡å•†
```

è¯¦ç»†æ¶æ„è®¾è®¡è¯·å‚è€ƒ [ç³»ç»Ÿæ¶æ„æ–‡æ¡£](docs/system-architecture-v2.md)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶

ç¡®ä¿ä»¥ä¸‹æœåŠ¡æ­£åœ¨è¿è¡Œï¼š

- ğŸ”§ **gpt-load** æœåŠ¡ (é»˜è®¤ç«¯å£ 3001)
- ğŸŒ **uni-api** é¡¹ç›®ä½äº `../uni-api` ç›®å½•
- ğŸš€ **bun** è¿è¡Œæ—¶ç¯å¢ƒ (æ¨èç‰ˆæœ¬ >= 1.0.0)

### å®‰è£…æ­¥éª¤

0. **å®‰è£… bun**ï¼ˆå¦‚æœè¿˜æ²¡æœ‰å®‰è£…ï¼‰

```bash
# macOS/Linux
curl -fsSL https://bun.sh/install | bash

# Windows (ä½¿ç”¨ PowerShell)
powershell -c "irm bun.sh/install.ps1 | iex"

# æˆ–ä½¿ç”¨ npm
npm install -g bun
```

1. **å…‹éš†é¡¹ç›®**

```bash
git clone <é¡¹ç›®åœ°å€>
cd uni-load
```

2. **å®‰è£…ä¾èµ–**

```bash
bun install
```

3. **é…ç½® gpt-load å®ä¾‹**ï¼ˆå¿…éœ€æ­¥éª¤ï¼‰

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp gptload-instances.json.example gptload-instances.json

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè‡³å°‘é…ç½®æœ¬åœ°å®ä¾‹
# ç¤ºä¾‹ï¼šä¿®æ”¹ urlã€token ç­‰å‚æ•°
```

4. **é…ç½®ç¯å¢ƒå˜é‡**

```bash
# æ¨èï¼šç›´æ¥åˆ›å»ºæœ¬åœ°é…ç½®æ–‡ä»¶
cp .env.example .env.local

# ç¼–è¾‘æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®ä½ çš„ç¯å¢ƒè°ƒæ•´å‚æ•°
# .env.local ä¼˜å…ˆçº§æ›´é«˜ä¸”ä¸ä¼šè¢«æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
```

5. **å¯åŠ¨æœåŠ¡**

```bash
bun start
# æˆ–å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
bun dev
```

6. **è®¿é—®é¡µé¢**

```
http://localhost:3002
```

## ğŸ› ï¸ åŸºæœ¬ä½¿ç”¨

### Web ç•Œé¢æ“ä½œ

1. æ‰“å¼€ `http://localhost:3002`
2. å¡«å†™ AI ç«™ç‚¹ä¿¡æ¯ï¼ˆAPIåœ°å€ã€å¯†é’¥ã€æ ¼å¼ç±»å‹ï¼‰
3. ç‚¹å‡»"ğŸ”§ å¼€å§‹é…ç½®"
4. ç­‰å¾…è‡ªåŠ¨é…ç½®å®Œæˆ

### API æ¥å£è°ƒç”¨

```bash
# é…ç½® AI ç«™ç‚¹
curl -X POST http://localhost:3002/api/process-ai-site \
  -H "Content-Type: application/json" \
  -d '{
    "baseUrl": "https://api.deepseek.com/v1",
    "apiKeys": ["sk-xxx"],
    "channelTypes": ["openai"]
  }'
```

è¯¦ç»† API è¯´æ˜è¯·å‚è€ƒ [API æ¥å£æ–‡æ¡£](docs/api.md)

## ğŸ“ é¡¹ç›®ç»“æ„

```
uni-load/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ types.ts                  # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ gptload.ts               # gpt-load æœåŠ¡äº¤äº’
â”‚   â”œâ”€â”€ multi-gptload.ts         # å¤šå®ä¾‹ç®¡ç†
â”‚   â”œâ”€â”€ models.ts                # æ¨¡å‹è·å–æœåŠ¡
â”‚   â”œâ”€â”€ yaml-manager.ts          # uni-api é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ model-sync.ts            # æ¨¡å‹åŒæ­¥æœåŠ¡
â”‚   â”œâ”€â”€ channel-health.ts        # æ¸ é“å¥åº·ç›‘æ§
â”‚   â”œâ”€â”€ channel-cleanup.ts       # æ¸ é“æ¸…ç†æœåŠ¡
â”‚   â”œâ”€â”€ model-config.ts          # æ¨¡å‹é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ model-channel-optimizer.ts # æ¨¡å‹æ¸ é“ä¼˜åŒ–
â”‚   â”œâ”€â”€ three-layer-architecture.ts # ä¸‰å±‚æ¶æ„ç®¡ç†
â”‚   â””â”€â”€ temp-group-cleaner.ts    # ä¸´æ—¶åˆ†ç»„æ¸…ç†
â”œâ”€â”€ public/                      # é™æ€èµ„æº
â”‚   â””â”€â”€ index.html              # Webç•Œé¢
â”œâ”€â”€ docs/                       # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture.md         # ç³»ç»Ÿæ¶æ„è®¾è®¡
â”‚   â”œâ”€â”€ api.md                  # API æ¥å£æ–‡æ¡£
â”‚   â”œâ”€â”€ deployment.md           # éƒ¨ç½²æŒ‡å—
â”‚   â”œâ”€â”€ development.md          # å¼€å‘æŒ‡å—
â”‚   â””â”€â”€ multi-gptload-config.md # å¤šå®ä¾‹é…ç½®è¯´æ˜
â”œâ”€â”€ logs/                       # æ—¥å¿—ç›®å½•
â”œâ”€â”€ dist/                       # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ server.ts                   # ä¸»æœåŠ¡å™¨æ–‡ä»¶
â”œâ”€â”€ tsconfig.json              # TypeScript é…ç½®
â”œâ”€â”€ package.json               # é¡¹ç›®é…ç½®
â”œâ”€â”€ bunfig.toml                # Bun é…ç½®
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .env.local                 # æœ¬åœ°ç¯å¢ƒå˜é‡
â”œâ”€â”€ gptload-instances.json     # gpt-load å®ä¾‹é…ç½®
â””â”€â”€ README.md                  # è¯´æ˜æ–‡æ¡£
```

## âš™ï¸ ç¯å¢ƒé…ç½®

ç³»ç»Ÿæ”¯æŒå¤šç§é…ç½®æ–¹å¼ï¼Œè¯¦ç»†é…ç½®è¯´æ˜è¯·å‚è€ƒ [éƒ¨ç½²æŒ‡å—](docs/deployment.md)

### åŸºæœ¬é…ç½®

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp .env.example .env.local
cp gptload-instances.json.example gptload-instances.json

# ç¼–è¾‘é…ç½®
vim .env.local              # ç¯å¢ƒå˜é‡é…ç½®  
vim gptload-instances.json  # gpt-load å®ä¾‹é…ç½®
```

## ğŸ“š æ–‡æ¡£ç›®å½•

### åŸºç¡€æ–‡æ¡£
- ğŸ“– [ç³»ç»Ÿæ¶æ„è®¾è®¡](docs/architecture.md) - è¯¦ç»†çš„æ¶æ„è®¾è®¡å’Œç»„ä»¶è¯´æ˜
- ğŸ”Œ [API æ¥å£æ–‡æ¡£](docs/api.md) - å®Œæ•´çš„ API æ¥å£è§„èŒƒå’Œç¤ºä¾‹
- ğŸš€ [éƒ¨ç½²æŒ‡å—](docs/deployment.md) - å¤šç§ç¯å¢ƒçš„éƒ¨ç½²æ–¹æ¡ˆå’Œé…ç½®
- ğŸ› ï¸ [å¼€å‘æŒ‡å—](docs/development.md) - å¼€å‘ç¯å¢ƒè®¾ç½®å’Œç¼–ç è§„èŒƒ
- âš™ï¸ [å¤šå®ä¾‹é…ç½®è¯´æ˜](docs/multi-gptload-config.md) - gpt-load å¤šå®ä¾‹é…ç½®è¯¦è§£

### è¿›é˜¶æ–‡æ¡£
- ğŸ‘¤ [ç”¨æˆ·æ“ä½œæ‰‹å†Œ](docs/user-guide.md) - Web ç•Œé¢å’Œ API ä½¿ç”¨çš„è¯¦ç»†æŒ‡å—
- ğŸ—ï¸ [æ¨¡å—è®¾è®¡æ–‡æ¡£](docs/module-design.md) - è¯¦ç»†çš„æ¨¡å—æ¶æ„å’Œè®¾è®¡æ¨¡å¼
- ğŸ›ï¸ [ç³»ç»Ÿæ¶æ„è®¾è®¡ v2.0](docs/system-architecture-v2.md) - ä¸‰å±‚æ¶æ„çš„æ·±åº¦è§£æ

## ğŸ”„ å·¥ä½œæµç¨‹

1. **æ¨¡å‹å‘ç°** - è°ƒç”¨ AI ç«™ç‚¹çš„ `/v1/models` æ¥å£è·å–æ¨¡å‹åˆ—è¡¨
2. **åˆ†ç»„åˆ›å»º** - åœ¨ gpt-load ä¸­åˆ›å»ºä¸‰å±‚åˆ†ç»„æ¶æ„
3. **é…ç½®æ›´æ–°** - è‡ªåŠ¨æ›´æ–° uni-api çš„ `api.yaml` é…ç½®
4. **è´Ÿè½½å‡è¡¡** - å®ç°å¤šç«™ç‚¹ã€å¤šå¯†é’¥çš„æ™ºèƒ½è´Ÿè½½å‡è¡¡

## ğŸ” æ ¸å¿ƒç‰¹æ€§

### âœ… ä¸»è¦åŠŸèƒ½
- ğŸŒ **Web ç•Œé¢ç®¡ç†** - ç›´è§‚çš„é…ç½®ç•Œé¢
- ğŸ” **è‡ªåŠ¨æ¨¡å‹å‘ç°** - æ”¯æŒæ ‡å‡† OpenAI API æ ¼å¼
- ğŸ—ï¸ **ä¸‰å±‚åˆ†ç»„æ¶æ„** - çµæ´»çš„è´Ÿè½½å‡è¡¡ç­–ç•¥
- ğŸ”„ **å¤šå®ä¾‹æ”¯æŒ** - æ”¯æŒå¤šä¸ª gpt-load å®ä¾‹åè°ƒå·¥ä½œ
- ğŸ“Š **å®æ—¶ç›‘æ§** - å¥åº·æ£€æŸ¥å’ŒçŠ¶æ€ç›‘æ§
- ğŸ”§ **è‡ªåŠ¨åŒ–è¿ç»´** - æ¨¡å‹åŒæ­¥ã€æ•…éšœæ¢å¤

### ğŸ¯ æŠ€æœ¯ç‰¹ç‚¹
- **TypeScript** - ç±»å‹å®‰å…¨çš„ä»£ç è´¨é‡ä¿è¯
- **æ¨¡å—åŒ–è®¾è®¡** - æ¸…æ™°çš„æœåŠ¡å±‚åˆ†ç¦»
- **å®¹é”™æœºåˆ¶** - å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ¢å¤
- **æ€§èƒ½ä¼˜åŒ–** - è¿æ¥æ± ã€ç¼“å­˜å’Œå¹¶å‘æ§åˆ¶

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
bun dev

# ç”Ÿäº§æ„å»ºå’Œå¯åŠ¨
bun run build && bun start

# å¥åº·æ£€æŸ¥
curl http://localhost:3002/api/health

# æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
curl http://localhost:3002/api/status
```

## ğŸ› æ•…éšœæ’æŸ¥

è¯¦ç»†çš„æ•…éšœæ’æŸ¥æŒ‡å—è¯·å‚è€ƒ [ç”¨æˆ·æ“ä½œæ‰‹å†Œ](docs/user-guide.md#æ•…éšœæ’æŸ¥)

### å¿«é€Ÿæ£€æŸ¥

1. **æœåŠ¡çŠ¶æ€** - ç¡®è®¤ gpt-load å’Œ uni-api æœåŠ¡æ­£å¸¸è¿è¡Œ
2. **é…ç½®æ–‡ä»¶** - æ£€æŸ¥ `gptload-instances.json` å’Œç¯å¢ƒå˜é‡é…ç½®
3. **ç½‘ç»œè¿æ¥** - æµ‹è¯•åˆ° AI ç«™ç‚¹å’Œ gpt-load å®ä¾‹çš„è¿é€šæ€§
4. **æ—¥å¿—åˆ†æ** - æŸ¥çœ‹ `logs/` ç›®å½•ä¸‹çš„è¯¦ç»†æ—¥å¿—

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™‹â€â™‚ï¸ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚

---

**âš¡ è®© AI æ¨¡å‹ç®¡ç†å˜å¾—ç®€å•é«˜æ•ˆï¼**
